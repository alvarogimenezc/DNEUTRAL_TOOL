services:
 api_calculator:

    image:  imagen_apis                     #Previamente construida con el dockefile (build), revisar docker desktop OK
    working_dir: /api_service
    container_name: contenedor_api
    volumes: 
        - volumen_compartido:/shared_data   #Montamos el volumen compartido en una nueva carpeta /shared data a la altura de /api_service
    restart: unless-stopped                 #Se auto-levanta si se para en algun momento (pérdida conexión por ejemplo)
    
streamlit_app:
    image: streamlit_image
    working_dir: /frontend_service
    container_name: contenedor_frontend
    volumes:
      - volumen_compartido:/shared_data     #Comparte el volumen con el backend
    depends_on:
      - api_calculator                      #Asegura que el backend arranque primero
    ports:
      - "8501:8501"                         #Expone el puerto de Streamlit
    restart: unless-stopped

#Declaramos el volumen compartido con nombre volumen_compartido, así será visible para el resto de servicios
volumes:
  - volumen_compartido:/shared_data

 